"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[394],{30668:function(oe,V,r){var X=r(76361),l=r(41699),d=r(13178),F=r(96773),E=function(k){var I=k.spinning,W=I===void 0?!0:I,z=k.tip,M=z===void 0?"Loading ...":z,q=k.style;return(0,F.jsx)(X.Z,{indicator:(0,F.jsx)(d.Z,{spin:!0}),spinning:W,tip:M,style:q,children:k.children})};V.Z=E},13463:function(oe,V,r){r.r(V),r.d(V,{default:function(){return Ve}});var X=r(48305),l=r.n(X),d=r(41699),F=r(19364),E=r(69376),R=r(15175),k=r(27617),I=r(80846),W=r(91080),z=r(91941),M=r(10150),q=r(15558),ee=r.n(q),ae=r(96608),se=r(1613),w=r(63650),p=r(56699),_=r(29913),f=r(58357),j=r(78439),U=r(60152),e=r(96773),fe=function(n){var o=n.itemType;switch(o){case 0:case"file":case"file_pair":return(0,e.jsx)(p.Z,{});case 1:case"dir":return(0,e.jsx)(j.Z,{});case"project":return(0,e.jsx)(U.Z,{});default:return(0,e.jsx)(e.Fragment,{})}},L=fe,ne=r(30668),ue=function(n){var o=n.category,s=n.onItemClick,u=n.allowedRecordType,t=u===void 0?[0,1]:u,i=(0,d.useState)([]),a=l()(i,2),c=a[0],v=a[1],h=(0,d.useState)(!1),P=l()(h,2),y=P[0],m=P[1];return(0,d.useEffect)(function(){m(!0),(0,E.bS)(o,1,1e6,t).then(function(T){v(T.data.records)}).finally(function(){m(!1)})},[]),(0,e.jsx)(ne.Z,{spinning:y,children:(0,e.jsx)("div",{style:{padding:"8px"},children:(0,e.jsx)(f.Z,{style:{maxHeight:"500px",overflow:"auto"},dataSource:c,renderItem:function(g){return(0,e.jsx)(f.Z.Item,{children:(0,e.jsx)(M.ZP,{type:"text",onClick:function(){return s==null?void 0:s(g)},icon:(0,e.jsx)(L,{itemType:g.type}),disabled:!t.includes(g.type),children:g.name})},g.uid)}})})})},ye=ue,_e=r(42111),je=function(n){var o=n.name,s=n.uid,u=n.category,t=n.allowedRecordType,i=t===void 0?[0]:t,a=n.onItemClick,c=(0,d.useState)([]),v=l()(c,2),h=v[0],P=v[1],y=(0,d.useState)(!1),m=l()(y,2),T=m[0],g=m[1];return(0,d.useEffect)(function(){g(!0),(0,E.Qm)(u,s).then(function(S){P(S.data.files)}).finally(function(){g(!1)})},[]),(0,e.jsx)(ne.Z,{spinning:T,children:(0,e.jsxs)("div",{style:{padding:"8px",maxHeight:"500px",overflow:"auto"},children:[h.length==0&&(0,e.jsx)(_e.Z,{}),h.map(function(S){return(0,e.jsx)("div",{children:(0,e.jsx)(W.Z,{title:S.name,size:"small",style:{marginBottom:"12px"},children:(0,e.jsx)(f.Z,{style:{maxHeight:"500px",overflow:"auto"},dataSource:S.files,renderItem:function(D){return(0,e.jsx)(f.Z.Item,{children:(0,e.jsx)(M.ZP,{type:"text",onClick:function(){return a==null?void 0:a(D)},disabled:!i.includes(0),icon:(0,e.jsx)(L,{itemType:"file"}),children:D.name})},D.uid)}})})},S.name)})]})})},Se=je,Ce=r(46507),Ee=function(n){var o=n.category,s=n.onItemClick,u=n.allowedRecordType,t=u===void 0?[0]:u,i=(0,d.useState)([]),a=l()(i,2),c=a[0],v=a[1],h=(0,d.useState)(null),P=l()(h,2),y=P[0],m=P[1],T=(0,d.useState)(!1),g=l()(T,2),S=g[0],C=g[1],D=function(Z){m(Z)};return(0,d.useEffect)(function(){C(!0),(0,E.bS)(o,1,1e6).then(function(O){v(O.data.records)}).finally(function(){C(!1)})},[]),(0,e.jsxs)(ne.Z,{spinning:S,children:[y&&(0,e.jsx)("div",{style:{padding:"8px",borderBottom:"solid 1px rgb(240,240,240)"},children:(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(M.ZP,{icon:(0,e.jsx)(Ce.Z,{}),size:"small",onClick:function(){m(null)}}),y==null?void 0:y.name]})}),y?(0,e.jsx)(Se,{category:o,name:y.name,uid:y.uid,allowedRecordType:t,onItemClick:s}):(0,e.jsx)(f.Z,{style:{padding:"8px",maxHeight:"500px",overflow:"auto"},dataSource:c,renderItem:function(Z){return(0,e.jsx)(f.Z.Item,{children:(0,e.jsx)(M.ZP,{type:"text",onClick:function(){return D(Z)},icon:(0,e.jsx)(L,{itemType:"project"}),children:Z.name})},Z.uid)}})]})},we=Ee,Re=function(n){var o=n.border,s=o===void 0?!1:o,u=n.onItemClicked,t=n.type,i=t===void 0?[0,1]:t,a=d.useState([]),c=l()(a,2),v=c[0],h=c[1],P=d.useState(null),y=l()(P,2),m=y[0],T=y[1],g=d.useState(!1),S=l()(g,2),C=S[0],D=S[1];(0,d.useEffect)(function(){D(!0),(0,E.y1)().then(function(x){h(x.data.category);var A=x.data.category.find(function(N){return N.url=="dataset"});T(A||x.data.category[0])}).finally(function(){D(!1)})},[]);var O=function(A){var N=v.find(function(te){return te.url==A});N?T(N):console.error("Unknown category ".concat(A))},Z=v.map(function(x){return{key:x.url,item:x,label:(0,e.jsx)("div",{children:x.label})}}),G=function(){switch(m==null?void 0:m.type){case"list":return(0,e.jsx)(ye,{category:m.url,onItemClick:u,allowedRecordType:i});case"tree":return(0,e.jsx)(we,{category:m.url,onItemClick:u,allowedRecordType:i});default:return(0,e.jsx)(e.Fragment,{})}};return(0,e.jsxs)("div",{style:{border:s?"1px solid rgb(240,240,240)":"",display:"flex",flexDirection:"row"},children:[(0,e.jsx)(ne.Z,{spinning:C,children:(0,e.jsx)(_.Z,{selectedKeys:m!=null&&m.url?[m==null?void 0:m.url]:[],style:{minWidth:"160px",minHeight:"400px",border:"0px"},onClick:function(A){O(A.key)},mode:"inline",items:Z})}),(0,e.jsx)("div",{style:{width:"100%",borderLeft:"1px solid rgb(240,240,240)"},children:G()})]})},Me=Re,Pe=r(82153),Te=Pe.Z.Text,Ie=function(n){var o=n.exactFiles,s=o===void 0?null:o,u=n.maxFiles,t=u===void 0?s:u,i=n.minFiles,a=i===void 0?s:i,c=n.allowDuplicate,v=c===void 0?!1:c,h=n.onFileSelectSubmit,P=n.buttonText,y=P===void 0?"OK":P,m=n.type,T=m===void 0?[0,1]:m,g=(0,d.useState)([]),S=l()(g,2),C=S[0],D=S[1],O=(0,d.useState)(null),Z=l()(O,2),G=Z[0],x=Z[1],A=function(B){D(C.filter(function(re){return re.uid!==B.uid}))},N=function(){s!=null&&C.length!=s?x("Please select ".concat(s," files.")):a!=null&&C.length<a?x("Select at least ".concat(a," files.")):(h==null||h(C),x(null))},te=function(B){s==1||t==1?(D([B]),x(null)):s!=null&&C.length==s?x("Can select at most ".concat(s," files.")):t!=null&&C.length==t?x("Can select at most ".concat(t," files.")):!v&&C.find(function(re){return re.uid==B.uid})?x("Cannot select a file twice."):(D([].concat(ee()(C),[B])),x(null))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Me,{border:!0,onItemClicked:te,type:T}),G!=null&&(0,e.jsx)(Te,{style:{color:"red"},children:G}),(0,e.jsx)("div",{children:C.map(function(K){return(0,e.jsx)("div",{children:(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(L,{itemType:K.type}),K.name,(0,e.jsx)(M.ZP,{size:"small",type:"text",icon:(0,e.jsx)(se.Z,{}),onClick:function(){return A(K)}})]})},K.uid)})}),(0,e.jsx)("div",{style:{marginTop:"12px",textAlign:"end"},children:(0,e.jsx)(M.ZP,{type:"primary",icon:(0,e.jsx)(w.Z,{}),onClick:N,children:y})})]})},be=Ie,pe=49,me=17,De=function(){var b=(0,d.useState)({width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,heightNoHeader:document.documentElement.clientHeight-(pe+me)}),n=l()(b,2),o=n[0],s=n[1],u=(0,d.useCallback)(function(){var t={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,heightNoHeader:document.documentElement.clientHeight-(pe+me)};s(t)},[]);return(0,d.useEffect)(function(){return window.addEventListener("resize",u),function(){window.removeEventListener("resize",u)}},[u]),{W:o.width,H:o.height,C:o.heightNoHeader}},Ze=function(n){var o=n.id,s=n.value,u=s===void 0?{}:s,t=n.onChange,i=n.multiple,a=n.filePerRecord,c=a===void 0?1:a,v=n.type,h=v===void 0?[0,1]:v,P=n.allowDuplicate,y=P===void 0?!1:P,m=n.unlistSingleFile,T=m===void 0?!0:m,g=n.unlistSingleRecord,S=g===void 0?!0:g,C=De(),D=C.W,O=C.H,Z=(0,d.useState)([]),G=l()(Z,2),x=G[0],A=G[1],N=(0,d.useState)(!1),te=l()(N,2),K=te[0],B=te[1],re=function($){var Y=$.map(function(ie){return ie.uid});Y.sort();var J=Y.join("--");if(i){if(y||!y&&!x.find(function(ie){return ie.uid==J})){var le=[].concat(ee()(x),[{uid:J,record:$}]);A(le),ce(le)}}else{var H=[{uid:J,record:$}];A(H),ce(H)}B(!1)},Ge=function($){var Y=x.filter(function(J){return J.uid!==$});A(Y),ce(Y)},ce=function($){if($.length==0){t==null||t([]);return}var Y=$.map(function(H){return{uid:H.uid,record:H.record.map(function(ie){return ie.uid})}}),J=c==1&&T?Y.map(function(H){return{uid:H.uid,record:H.record[0]}}):Y,le=!i&&S?J[0].record:J.map(function(H){return H.record});t==null||t(le)},Ne=function(){B(!1)},he=function(){B(!0)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{children:[x.map(function(Q){return(0,e.jsxs)("div",{style:{margin:"4px 0",padding:"4px",borderRadius:"4px",border:"solid 1px rgb(217,217,217)",display:"flex",alignItems:"center"},children:[(0,e.jsx)(M.ZP,{type:"text",icon:(0,e.jsx)(se.Z,{}),style:{marginRight:"4px"},onClick:function(){Ge(Q.uid)}}),(0,e.jsx)("div",{children:Q.record.map(function($){return(0,e.jsx)("div",{children:i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L,{itemType:$.type})," ",$.name]}):(0,e.jsx)(M.ZP,{type:"text",onClick:he,icon:(0,e.jsx)(L,{itemType:$.type}),children:$.name})},$.uid)})})]},Q.uid)}),(x.length==0||i)&&(0,e.jsx)(M.ZP,{onClick:he,icon:i?(0,e.jsx)(w.Z,{}):(0,e.jsx)(p.Z,{}),block:!0,children:i?(0,e.jsx)(e.Fragment,{children:"Add"}):(0,e.jsx)(e.Fragment,{children:"Select"})})]}),(0,e.jsx)(ae.Z,{width:Math.max(700,Math.round(D*.75)),onCancel:Ne,destroyOnClose:!0,title:"Explorer - Select ".concat(c," item").concat(c>1?"s":""),open:K,okText:"Add",maskClosable:!1,footer:!1,children:(0,e.jsx)(be,{exactFiles:c,allowDuplicate:!1,onFileSelectSubmit:re,type:h})})]})},de=Ze,Fe=r(29149),Oe=r(55513),$e=function(n){var o=n.uid,s=n.name,u=n.type,t=n.size,i=function(){window.open("/api/file/".concat(o))};return u=="dir"?(0,e.jsxs)("div",{children:[(0,e.jsx)(L,{itemType:u})," ",s]}):(0,e.jsxs)(I.Z,{align:"start",children:[(0,e.jsx)(L,{itemType:u}),s,(0,e.jsx)(M.ZP,{size:"small",icon:(0,e.jsx)(Fe.Z,{}),type:"text",onClick:i,children:t?(0,Oe.G)(t):""})]})},ve=$e,ke=function(n){var o=n.data,s=n.name,u=n.label,t=n.details,i=n.type,a=function(v){return(0,e.jsx)("div",{style:{margin:"4px 0",padding:"8px",borderRadius:"4px",border:"solid 1px rgb(217,217,217)"},children:Array.isArray(v)?(0,e.jsx)(e.Fragment,{children:v.map(function(h){return(0,e.jsx)("div",{children:(0,e.jsx)(ve,{type:i,name:h.name,size:h.size,uid:h.uid})},h.uid)})}):(0,e.jsx)(ve,{type:i,name:v.name,size:v.size,uid:v.uid})})};return t?(0,e.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,e.jsx)("h4",{children:u}),Array.isArray(t)?(0,e.jsx)(e.Fragment,{children:t.map(function(c,v){return(0,e.jsx)("div",{children:a(c)},"".concat(s,"-").concat(v))})}):(0,e.jsx)("div",{children:a(t)})]}):(0,e.jsx)(e.Fragment,{})},xe=ke,Le=r(51579),Ae=r(94280),We=function(n){var o=n.status,s=o===void 0?-1:o,u=n.showText,t=u===void 0?!1:u,i=(0,R.useIntl)();if(![0,1,2,3,4].includes(s))return(0,e.jsx)(e.Fragment,{});var a={0:i.formatMessage({id:"workspace_mission_pane_step_created",defaultMessage:"CREATED"}),1:i.formatMessage({id:"workspace_mission_pane_step_pending",defaultMessage:"PENDING"}),2:i.formatMessage({id:"workspace_mission_pane_step_processing",defaultMessage:"RUNNING"}),3:i.formatMessage({id:"workspace_mission_pane_step_success",defaultMessage:"DONE"}),4:i.formatMessage({id:"workspace_mission_pane_step_error",defaultMessage:"ERROR"})},c={0:"default",1:"default",2:"processing",3:"success",4:"error"};return(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(Le.Z,{status:c[s],text:t?a[s]:"",style:{color:"rgb(128,128,128)"}}),(0,e.jsx)(Ae.Z,{type:"vertical"})]})},ge=We,ze=function(n){var o=n.step,s=o.name,u=o.params,t=u===void 0?[]:u,i=o.status,a=(0,e.jsxs)(I.Z,{children:[(0,e.jsx)(ge,{status:i,showText:!0}),s]});return t!=null&&t.some(function(c){return Object.hasOwn(c,"data")})?(0,e.jsx)(W.Z,{title:a,children:t==null?void 0:t.map(function(c){return(0,e.jsx)(xe,{name:c.name,label:c.label,data:c.data,details:c.details},c.name)})}):(0,e.jsx)(W.Z,{title:a})},Be=function(n){switch(n.type){case"file_pair":return(0,e.jsx)(de,{multiple:n.multiple,type:[0],filePerRecord:2});case"file":return(0,e.jsx)(de,{multiple:n.multiple,type:[0],filePerRecord:1});case"dir":return(0,e.jsx)(de,{multiple:n.multiple,type:[1],filePerRecord:1});default:return(0,e.jsx)(e.Fragment,{})}},He=function(n){var o=(0,R.useIntl)(),s=n.step,u=n.onLaunch,t=s.name,i=s.params;return i!=null&&i.some(function(a){return Object.hasOwn(a,"data")})?(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(W.Z,{title:t,children:i==null?void 0:i.map(function(a){return(0,e.jsx)(xe,{name:a.name,label:a.label,data:a.data,details:a.details,type:a.type},a.name)})})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(W.Z,{title:t,children:(0,e.jsxs)(z.Z,{name:"inputForm",labelCol:{span:8},wrapperCol:{span:16},initialValues:{remember:!0},onFinish:u,autoComplete:"off",children:[i==null?void 0:i.map(function(a){return(0,e.jsx)(z.Z.Item,{label:a.label,name:a.name,rules:[{required:!0,message:"This field is required."}],children:Be(a)},a.name)}),(0,e.jsx)("div",{style:{textAlign:"end"},children:(0,e.jsx)(z.Z.Item,{label:null,children:(0,e.jsx)(M.ZP,{type:"primary",htmlType:"submit",children:"Launch"})})})]})})})},Ue=function(n,o){switch(n.type){case"input":return(0,e.jsx)(He,{onLaunch:o,step:n});case"step":case"output":return(0,e.jsx)(ze,{step:n});default:return(0,e.jsx)(e.Fragment,{})}},Ke=function(){var n=(0,R.useParams)(),o=n.missionId,s=d.useState(null),u=l()(s,2),t=u[0],i=u[1],a=d.useState(!1),c=l()(a,2),v=c[0],h=c[1],P=d.useState(!1),y=l()(P,2),m=y[0],T=y[1],g=(0,R.useIntl)(),S=(0,d.useCallback)(function(){o&&(h(!0),(0,E.nU)(o).then(function(O){return i(O.data)}).catch(function(){R.history.push("/404")}).finally(function(){h(!1)}))},[o]);(0,d.useEffect)(function(){S()},[S]);var C=[{key:"2",label:g.formatMessage({id:"workspace_mission_pane_description_created",defaultMessage:"Created"}),children:(0,k.j)(t==null?void 0:t.date_created)},{key:"3",label:g.formatMessage({id:"workspace_mission_pane_description_type",defaultMessage:"Type"}),children:t==null?void 0:t.type_name},{key:"4",label:g.formatMessage({id:"workspace_mission_pane_description_status",defaultMessage:"Status"}),children:(0,e.jsx)(ge,{status:t==null?void 0:t.status})},{key:"1",label:g.formatMessage({id:"workspace_mission_pane_description_id",defaultMessage:"Mission ID"}),children:o}],D=function(Z){T(!0),(0,E.MK)({uid:o,type:t==null?void 0:t.type,params:Z}).then(function(){S()}).finally(function(){T(!1)})};return v?(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",justifyContent:"center"},children:(0,e.jsx)(ne.Z,{spinning:v||m})}):(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,e.jsx)(F.Z,{title:t==null?void 0:t.name,items:C,style:{borderBottom:"1px solid rgb(220,220,220)",padding:"8px"}}),(0,e.jsx)("div",{style:{padding:"60px",display:"flex",flexDirection:"column",flex:1,overflow:"auto"},children:t==null?void 0:t.steps.map(function(O,Z){return(0,e.jsx)("div",{style:{marginBottom:"24px"},children:Ue(O,D)},Z)})})]})},Ve=Ke},69376:function(oe,V,r){r.d(V,{E6:function(){return M},MK:function(){return q},Qm:function(){return se},bS:function(){return ae},nU:function(){return z},o5:function(){return W},sS:function(){return k},y1:function(){return ee}});var X=r(90228),l=r.n(X),d=r(87999),F=r.n(d),E=r(15175),R=r(94942),k=function(){var w=F()(l()().mark(function p(){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,E.request)("/api/mission/types"));case 1:case"end":return f.stop()}},p)}));return function(){return w.apply(this,arguments)}}(),I=null,W=function(){var w=F()(l()().mark(function p(){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,E.request)("/api/mission",{params:{page_size:1e4}}));case 1:case"end":return f.stop()}},p)}));return function(){return w.apply(this,arguments)}}(),z=function(){var w=F()(l()().mark(function p(_){return l()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,E.request)("/api/mission/".concat(_),{}));case 1:case"end":return j.stop()}},p)}));return function(_){return w.apply(this,arguments)}}(),M=function(){var w=F()(l()().mark(function p(_){return l()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,E.request)("/api/mission",{method:"POST",data:_}));case 1:case"end":return j.stop()}},p)}));return function(_){return w.apply(this,arguments)}}(),q=function(){var w=F()(l()().mark(function p(_){return l()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,E.request)("/api/mission/launch",{method:"POST",data:_}));case 1:case"end":return j.stop()}},p)}));return function(_){return w.apply(this,arguments)}}(),ee=function(){var w=F()(l()().mark(function p(){return l()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,E.request)("/api/explorer",{}));case 1:case"end":return f.stop()}},p)}));return function(){return w.apply(this,arguments)}}(),ae=function(){var w=F()(l()().mark(function p(_){var f,j,U,e=arguments;return l()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return f=e.length>1&&e[1]!==void 0?e[1]:1,j=e.length>2&&e[2]!==void 0?e[2]:20,U=e.length>3&&e[3]!==void 0?e[3]:[0,1],L.abrupt("return",(0,E.request)("/api/explorer/".concat(_),{params:{page:f,page_size:j,type:U},paramsSerializer:function(ue){return R.Z.stringify(ue)}}));case 4:case"end":return L.stop()}},p)}));return function(_){return w.apply(this,arguments)}}(),se=function(){var w=F()(l()().mark(function p(_,f){return l()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.abrupt("return",(0,E.request)("/api/explorer/".concat(_,"/").concat(f),{}));case 1:case"end":return U.stop()}},p)}));return function(_,f){return w.apply(this,arguments)}}()},27617:function(oe,V,r){r.d(V,{U:function(){return d},j:function(){return F}});var X=r(31759),l=r.n(X),d=function(R,k){if(R==null)return!1;if(Array.isArray(R))return R.includes(k);if(l()(R)==="object")return R.hasOwnProperty(k)},F=function(R){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;if(!R)return"-";var I=new Date(R*k),W=String(I.getDate()).padStart(2,"0"),z=String(I.getMonth()+1).padStart(2,"0"),M=I.getFullYear(),q=String(I.getHours()).padStart(2,"0"),ee=String(I.getMinutes()).padStart(2,"0"),ae=String(I.getSeconds()).padStart(2,"0");return"".concat(M,"-").concat(z,"-").concat(W," ").concat(q,":").concat(ee)}}}]);
